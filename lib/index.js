"use strict";var v=require("node:crypto"),c=require("fs-extra"),g=require("node:os"),l=require("node:path"),W=require("@hattip/polyfills/node-fetch"),f=require("path");class q{#t=l.join(g.homedir(),"cache","fetch");#e(a){const r=v.createHash("sha512");r.update(a);const i=r.digest("base64");return l.join(this.#t,i)}async set(a,r){const i=this.#e(a);return await c.ensureFile(i),await c.writeFile(i,r,{encoding:"utf-8"})}async get(a){const r=this.#e(a);if(c.exists(r))return await c.ensureFile(r),await c.readFile(r,"utf-8")}}function d(s){return s?.startsWith("http://")||s?.startsWith("https://")}const w=new Map,C=function({cache:s=w,onRequest:a,onUseCache:r,fetcher:i,resolveIdFallback:h}={}){return W(),{name:"rollup-plugin-http-resolve",async resolveId(e,n){if(/^https?:\/\//.test(e))return e;if(n&&d(n)){if(e.startsWith("https://"))return e;const{pathname:t,protocol:o,host:u}=new URL(n);if(e.startsWith("/"))return`${o}//${u}${e}`;if(e.startsWith(".")){const p=f.join(f.dirname(t),e);return`${o}//${u}${p}`}}else if(h){const t=h(e,n);if(t)return t}},async load(e){if(e!==null&&d(e)){const n=await s.get(e);if(n)return r?.(e),n;if(a?.(e),i){const t=await i(e);return await s.set(e,t),t}else{const t=await fetch(e,{headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36 Edg/108.0.1462.54"}});if(!t.ok)throw t.statusText;const o=await t.text();return await s.set(e,o),o}}}}};exports.defaultCache=w,exports.fileCache=q,exports.httpResolve=C;
//# sourceMappingURL=index.js.map
